<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Filter</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { max-width: 600px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        label { display: block; margin-top: 10px; }
        select, input[type="number"] { width: 100%; margin-top: 5px; padding: 8px; }
        button { margin-top: 15px; padding: 10px 15px; cursor: pointer; }
        ul { list-style: none; padding-left: 0; }
    </style>
</head>
<body>
<div class="container">
    <h2>Game Filter</h2>
    <label>Year Range</label>
    <input type="number" id="year-start" placeholder="Start Year (e.g., 1971)" min="1971" max="2022">
    <input type="number" id="year-end" placeholder="End Year (e.g., 2022)" min="1971" max="2022">
    
    <label>Genres</label>
    <select id="genre-select" multiple>
        <!-- Genre options will be dynamically populated -->
    </select>
    
    <label>Platforms</label>
    <select id="platform-select" multiple>
        <!-- Platform options will be dynamically populated -->
    </select>
    
    <button onclick="filterGames()">Filter Games</button>
    
    <h3>Results:</h3>
    <ul id="results"></ul>
</div>

<script>
    let gamesData = {};

    // Load JSON data (assumes best_games_list.json is in the same directory)
    async function loadData() {
        const response = await fetch('best_games_list.json');
        gamesData= await response.json();
		
		populateGenres();
        populatePlatforms();
    }
	
	// Populate genres dynamically
    function populateGenres() {
        const genres = [...new Set(gamesData.map(game => game.Genre))];
        const genreSelect = document.getElementById('genre-select');
        genres.forEach(genre => {
            const option = document.createElement('option');
            option.value = genre;
            option.textContent = genre;
            genreSelect.appendChild(option);
        });
    }

    // Populate platforms dynamically
    function populatePlatforms() {
        const platforms = [...new Set(gamesData.map(game => game["Original platform(s)"]).flat())];
        const platformSelect = document.getElementById('platform-select');
        platforms.forEach(platform => {
            const option = document.createElement('option');
            option.value = platform;
            option.textContent = platform;
            platformSelect.appendChild(option);
        });

    // Filter and display games
    function filterGames() {
        const yearStart = parseInt(document.getElementById('year-start').value) || 1971;
        const yearEnd = parseInt(document.getElementById('year-end').value) || 2022;
        const selectedGenres = Array.from(document.getElementById('genre-select').selectedOptions).map(option => option.value);
        const selectedPlatforms = Array.from(document.getElementById('platform-select').selectedOptions).map(option => option.value);

        let filteredGames = gamesData.filter(game => {
            const matchesYear = game.Year >= yearStart && game.Year <= yearEnd;
            const matchesGenre = selectedGenres.length === 0 || selectedGenres.includes(game.Genre);
            const matchesPlatform = selectedPlatforms.length === 0 || selectedPlatforms.includes(game["Original platform(s)"]);
            return matchesYear && matchesGenre && matchesPlatform;
        });

        displayGames(shuffleArray(filteredGames).slice(0, 5));
    }

    // Display up to 5 games
    function displayGames(games) {
        const results = document.getElementById('results');
        results.innerHTML = '';
        games.forEach(game => {
            const li = document.createElement('li');
            li.textContent = `${game.Game} (${game.Year}) - ${game.Genre}`;
            results.appendChild(li);
        });
    }

    // Utility function to shuffle an array
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // Initialize data
    loadData();
</script>
</body>
</html>
